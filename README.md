# AvitoTech ML Cup 2025 — Персональные рекомендации

Решение задачи персональных рекомендаций в рамках Avito ML Cup 2025. Репозиторий содержит ноутбуки, формат сабмита, ссылку на исходные данные и краткое описание метода.

## Задача
Предсказать актуальные для пользователя группы товаров (`node`) по истории взаимодействий и метаинформации. Отклик определяется по контактным событиям (`is_contact = 1`). Метрика — **Recall@40**. Тест собран с лагом по времени. Проверка решений автоматическая, Public/Private = 30/70, до 5 сабмитов в день.

Страница соревнования: https://ods.ai/competitions/avitotechmlchallenge2025

## Данные
**Исходные файлы организатора (см. раздел Releases):**
- `text_features.pq` — вектора тайтлов объявлений (`title_projection: array[int8,64]`)
- `cat_features.pq` — фичи объявлений: `item, location, category, clean_params, node`
- `clickstream.pq` — история: `cookie, item, event, event_date, surface, platform, node`

**Сопутствующие файлы в репозитории (`data/raw/`):**
- `events.pq` — справочник событий: `event, is_contact`
- `test_users.pq` — пользователи для предсказаний: `cookie`
- `submit_example.csv` — пример формата отправки

**Ноутбуки (`notebooks/`):**
- `baseline.ipynb` — шаблон организатора (сбор теста и расчёт метрики)
- `avito_2025.ipynb` — рабочий ноутбук решения

**Сабмит (см. раздел Releases):**
- `submit.csv` — итоговый файл для отправки

## Формат сабмита
Две колонки:
- `cookie` — id пользователя
- `node` — предсказанный id группы товара  
Образец: `data/raw/submit_example.csv`.

## Метод
- Фильтрация контактных событий: `events.pq` → берем `event` с `is_contact=1`.  
- Чтение `clickstream.pq` с предикатом по `event` (pyarrow.dataset) и выбором колонок: `cookie, node, item, event_date, platform`.  
- Временное разделение: последние 14 дней — валидация; остальное — обучение.  
- Кандидаты: топ-1000 популярных `node` по обучающему окну; для каждого пользователя исключаются уже «виденные» `node`.  
- Признаки для (cookie, node):  
  `user_node_count` (частота взаимодействий пользователя с node в обучающем окне),  
  `node_popularity` (глобальная частота node),  
  `user_unique_nodes` (число уникальных node у пользователя),  
  `platform` (последняя платформа пользователя).  
- Модель: `CatBoostClassifier(iterations=200, depth=6, learning_rate=0.1, eval_metric="Recall")`.  
- Обучение: `train_test_split` c `stratify=y`.  
- Ранжирование: `predict_proba` → топ-40 `node` на пользователя → `submit.csv`.  
- Локальная валидация: собственная реализация **Recall@40** на валидационном окне.

## Результаты
| Показатель                      | Значение     |
|---------------------------------|--------------|
| Recall@40 (текущее решение)     | 0.0579503134 |
| Ориентир лидеров (Public)       | 0.2314696948 |

Решение зафиксировано как воспроизводимый baseline и отправная точка для дальнейшего повышения качества.

## Сертификат
[Скачать PDF](images/Шумский_Денис_Перс_рекомендации.pdf)

